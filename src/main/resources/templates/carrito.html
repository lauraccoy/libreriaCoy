<section th:fragment="contenido" class="container my-4">

  <h1 class="mb-4">Carrito</h1>

  <div th:if="${cart == null or #lists.isEmpty(cart.items)}" class="alert alert-info">
    Tu carrito está vacío.
  </div>

  <div th:if="${cart != null and !#lists.isEmpty(cart.items)}">

    <div class="table-responsive">
      <table class="table align-middle">
        <thead>
          <tr>
            <th>Producto</th>
            <th class="text-end">Precio</th>
            <th class="text-center">Cantidad</th>
            <th class="text-end">Subtotal</th>
            <th></th>
          </tr>
        </thead>

        <tbody>
          <tr th:each="it : ${cart.items}">
            <td th:text="${it.item.nombre}">Nombre</td>

            <td class="text-end"
                th:text="${#numbers.formatDecimal(it.item.precio,1,2)} + ' €'">0.00 €</td>

            <td class="text-center">
              <form th:action="@{/carrito/update}" method="post" class="d-inline-flex gap-2 align-items-center">
                <input type="hidden" name="tipo" th:value="${it.item.tipoProducto}">
                <input type="hidden" name="id" th:value="${it.item.id}">

                <input type="number" name="cantidad" min="1"
                       class="form-control form-control-sm" style="width:90px"
                       th:value="${it.quantity}">

                <button type="submit" class="btn btn-sm btn-outline-secondary">Actualizar</button>
              </form>
            </td>

            <td class="text-end"
                th:text="${#numbers.formatDecimal(it.subtotal,1,2)} + ' €'">0.00 €</td>

            <td class="text-end">
              <form th:action="@{/carrito/remove}" method="post">
                <input type="hidden" name="tipo" th:value="${it.item.tipoProducto}">
                <input type="hidden" name="id" th:value="${it.item.id}">
                <button type="submit" class="btn btn-sm btn-outline-danger">Quitar</button>
              </form>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="d-flex justify-content-end mt-3">
      <div class="card p-3" style="min-width: 280px;">
        <div class="d-flex justify-content-between">
          <span class="fw-bold">Total</span>
          <span class="fw-bold" th:text="${#numbers.formatDecimal(cart.total,1,2)} + ' €'">0.00 €</span>
        </div>
      </div>
    </div>

  </div>
</section>
